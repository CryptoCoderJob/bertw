import XCTest

@testable import PorscheConnect

final class OAuthApplicationTests: XCTestCase {
  
  func testInitOAuthToken() {
    let authResponse = AuthResponse(
      accessToken: "eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCIsImtpZCI6ImlLVTg4Mml1LWJBc1NmZTBJYmlNZCJ9.eyJodHRwczovL2lkZW50aXR5LnBvcnNjaGUuY29tL2NpYW1JZCI6Ijg3dWc4YmhtdnJ2cXltMWsiLCJjaWFtSWQiOiI4N3VnOGJobXZydnF5bTFrIiwiaHR0cHM6Ly9pZGVudGl0eS5wb3JzY2hlLmNvbS9qdGkiOiI1MmY5Njc3NWJhNTljNWQxZTkzOTcyY2Y0YzU4NGIwOSIsInBvcnNjaGVfanRpIjoiNTJmOTY3NzViYTU5YzVkMWU5Mzk39mNmNGM1ODRiMDkiLCJpc3MiOiJodHRwczovL2lkZW50aXR5LnBvcnNjaGUuY29tLyIsInN1YiI6ImF1dGgwfDY0NzZhMjU2Zjc1M2ZmNTVhZmNiM2NiZCIsImF1ZCI6WyJodHRwczovL2FwaS5wb3JzY2hlLmNvbSIsImh0dHBzOi8vcG9yc2NoZS1wcm9kdWN0aW9uLnBvcnNjaGUtcHJvZHVjdGlvbi5hdXRoMGFwcC5jb20vdXNlcmluZm8iXSwiaWF0IjoxNjg3MDE1MTQ1LCJleHAiOjE2ODcwNTgzNDUsImF6cCI6IlVZc0swME15NmJDcUpkYlFoVFEwUGJXbWNTZElBTWlnIiwic2NvcGUiOiJvcGVuaWQifQ.Su9WZjhwnWcvlo3TTrLIagFdyE62KkkDaQpp1vjJCUEoglxaXLilMdJMfgc8Tu7ByZEMx5dE4m8CkhIvGd4XJ_3_RhiRVaD1iWO3xBADhXl47vxU4W09NPUVdJ6350F9R0J0YfQDGxeNSGFDR9EfhqG07fsV-ioBB79yuRo1_dJMmo9RkvCywcvR6wk3XQS5hYMtGRJJc06WnECWPAJA5kkxieZUTjJu2Cj01RPRH3YKyr0K1s87YQ93EcnJcotSU2V_4XjOwpEcdkBQBE2lTY22zMiQAozMrAhxJi2miHznDV-jJIz6UJINu77mMBg7Ha0SsFeZhpjpuKrR20kq19A",
      idToken: "eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCIsImtpZCI6ImlLVTg4Mml1LWJBc1NmZTBJYmlNZCJ9.eyJodHRwczovL2lkZW50aXR5LnBvcnNjaGUuY29tL2NpYW1JZCI6Ijg3dWc4YmhtdnJ2cXltMWsiLCJjaWFtSWQiOiI4N3VnOGJobXZydnF5bTFrIiwiaXNzIjoiaHR0cHM6Ly9pZGVudGl0eS5wb3JzY2hlLmNvbS8iLCJhdWQiOiJVWXNLMDBNeTZiQ3FKZGJRaFRRMFBiV21jU2RJQU1pZyIsImlhdCI6MTY4NzAxNTE0NSwiZXhwIjoxNjg3MDE1NDQ1LCJzdWIiOiJhdXRoMHw2NDc2YTI1NmY3NTNmZjU1YWZjYjNjYmQiLCJzaWQiOiJ2XzVKWWtYRGVwSDBPcXhsUVhYZzlOdlBTN2hEazE5SyJ9.acDN_OOL31Ijt2649RCFsJoBBMdd_cpkwsqE10e5YehceJny4RXJD2yY38glIbW22oSK2XK62aVcGAX_K1WvQXxipN0fscfjkCIlCifzxT2sBDMnS3Mw6sD3mfmWN_PmVQuMfziSx1plJrlZgXfjX6y0mW5tf-7mLxdsN7KRZisN1ERDKrpmfdVy-oj-k_0K6vh_KtfPWHR1ALdWJWmIccVN8tRgtajfUZaDwr5bQk1FwtE3FAAMmyWnDHcRNH_v9uLL11MvuqZQHIQHelC_OhWz2A1o4B-gs1KPg66c6090k-Qb7JOLWPjtyORDRLLb5P7sisehS0-PaA5p9txbhg",
      tokenType: "Bearer",
      scope: "openid",
      expiresIn: 43200)
    
    let oauthToken = OAuthToken(authResponse: authResponse)
    XCTAssertEqual("UYsK00My6bCqJdbQhTQ0PbWmcSdIAMig", oauthToken.apiKey)
  }
}
